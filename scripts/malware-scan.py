from huggingface_hub import model_info

try:
    # We don't need expand=["security"] here; it's handled via sibling attributes
    info = model_info("star23/baller13")
    
    print(f"--- Security Metadata for {info.id} ---")
    
    for file in info.siblings:
        # The library maps 'security' data if available
        # Note: 'security' is a dictionary containing 'claims' or 'clamav' status
        sec = getattr(file, "security", None)
        
        if sec:
            # Most infected files will show up in the 'clamav' or 'pickle_import' keys
            status = sec.get("clamav", "No ClamAV data")
            print(f"File: {file.rfilename:30} | Status: {status}")
        else:
            print(f"File: {file.rfilename:30} | Status: No security data found")

except Exception as e:
    print(f"Error fetching model info: {e}")
